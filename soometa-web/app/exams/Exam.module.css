
/* --- Main Layout (Desktop First - Sidebar bên phải) --- */
.appContainer {
  display: flex;
  max-width: 1300px;
  margin: 30px auto;
  padding: 0 20px;
  gap: 25px;
  align-items: flex-start;
}

.mainContent {
  flex: 1;
  min-width: 0;
  background-color: #ffffff;
  padding: 35px 45px;
  border-radius: 8px;
  border: 1px solid var(--border-color-light, #f1f3f5);
  box-shadow: none;
  max-width: none;
  margin: 0;
}

.sidebar {
  flex-basis: 220px;
  flex-shrink: 0;
  max-width: 220px;
  background-color: #ffffff;
  padding: 20px 15px;
  border-radius: 8px;
  border: 1px solid var(--border-color-light, #f1f3f5);
  box-shadow: none;
  position: sticky;
  top: 30px;
  max-height: calc(100vh - 60px);
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: #ced4da #f1f3f5;
  transition: opacity 0.3s ease, visibility 0.3s ease;
  display: flex;
  flex-direction: column;
}
.sidebar::-webkit-scrollbar { width: 5px; }
.sidebar::-webkit-scrollbar-track { background: #f8f9fa; border-radius: 3px; }
.sidebar::-webkit-scrollbar-thumb { background-color: #ced4da; border-radius: 3px; }

.sidebarTitle {
  font-size: 1.15em;
  font-weight: 600;
  color: var(--heading-color, #212529);
  margin: 0 0 15px 0;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--border-color, #dee2e6);
  text-align: center;
}

/* --- Exam Title --- */
.examTitle {
  text-align: center;
  color: var(--heading-color, #333);
  margin: 0 auto 45px auto;
  font-size: 1.6em;
  font-weight: 600;
}

/* --- Styling for Exam Content (Tối giản) --- */
.instructionGroup {
  margin-bottom: 30px;
  padding-top: 15px;
  background-color: transparent;
  border-radius: 0;
  box-shadow: none;
  border-left: none;
}
.mainContent > div:first-child > .instructionGroup:first-child {
  padding-top: 0;
}
.instructionGroup > .instructionText:first-child {
  margin-top: 0;
}

.instructionText {
  font-weight: bold;
  background-color: transparent;
  padding: 0;
  border-left: none;
  margin-bottom: 25px;
  font-size: 1.1em;
  color: var(--heading-color, #333);
  line-height: 1.6;
  white-space: pre-wrap;
  word-wrap: break-word;
}
.instructionText u { font-size: inherit; text-decoration: underline; background: none; }
.instructionText b { font-weight: bold; }

/* == Style cho Shared Content / Passage == */
.sharedContent {
  margin-bottom: 35px;
  padding: 0px !important;
  background-color: #f8f9fa;
  border: none;
  border-radius: 6px;
  white-space: pre-wrap;
  word-wrap: break-word;
  font-size: 1.05em;
  line-height: 1.6;
  color: var(--text-color, #495057);
}
.sharedContent .questionPassage {
  padding-top: 0px;
  padding-bottom: 0px;
}
.sharedContent u, .questionPassage u {
  text-decoration: underline;
  background-color: var(--highlight-bg, #fff9e0);
  padding: 1px 3px;
  border-radius: 2px;
}
.sharedContent b, .questionPassage b {
  font-weight: 600;
  color: var(--heading-color, #212529);
}
.sharedContent .blank-marker, .questionPassage .blank-marker {
  font-weight: bold;
  color: var(--danger-color, #dc3545);
  background: none;
  padding: 0 2px;
  border-bottom: 1px dashed currentColor;
}
.sharedContent .insertion-point, .questionPassage .insertion-point {
  font-weight: bold;
  color: var(--primary-color, #0d6efd);
  background: var(--primary-color-light, #e7f3ff);
  padding: 1px 6px;
  border-radius: 3px;
  display: inline-block;
  margin: 0 2px;
  cursor: default;
  font-size: 1.05em;
}

/* == Style cho Ảnh trong Shared Content == */
.sharedImage {
  max-width: 100%;
  max-height: 300px; /* THÊM: Giới hạn chiều cao tối đa */
  width: auto;
  height: auto;
  object-fit: contain; /* THÊM: Giữ tỷ lệ khung hình */
  display: block;
  margin: 15px auto;
  border: 1px solid #e9ecef;
  border-radius: 4px;
}

/* == Style cho Passage == */
.questionPassage {
  /* margin-bottom: 20px; */
  padding: 18px 20px;
  background-color: #f8f9fa;
  border: none;
  border-radius: 6px;
  white-space: pre-wrap;
  word-wrap: break-word;
  font-size: 1.05em;
  line-height: 1.6;
  color: var(--text-color, #495057);
}

.questionBlock {
  margin-bottom: 30px;
  padding-bottom: 0;
  scroll-margin-top: 80px;
}

.highlightedQuestion {
  background-color: transparent;
  box-shadow: none;
  margin: 0;
  padding: 0;
}

.questionHeader {
  display: flex;
  margin-bottom: 12px;
  /* flex-wrap: wrap; */
}
.questionNumber {
  font-weight: bold;
  margin-right: 10px;
  font-size: 1.1em;
  color: var(--heading-color, #333);
  background: none;
  padding: 0;
  min-width: auto;
}
.questionPoints {
  font-size: 0.9em;
  color: var(--text-color, #555);
  margin-left: 8px;
  padding-left: 0;
  white-space: nowrap;
  align-self: baseline;
}

.questionContent {
  /* margin-bottom: 15px; */
}
.questionText, .instructionValue {
  margin-bottom: 10px;
  padding: 0;
  font-size: 1.1em;
  line-height: 1.6;
  white-space: pre-wrap;
  word-wrap: break-word;
  color: var(--heading-color, #333);
}
.questionText u {
  text-decoration: underline;
  background-color: var(--highlight-bg, #fff9e0);
  padding: 1px 3px;
  border-radius: 2px;
}
.questionText .blank-marker {
  font-weight: bold;
  color: var(--danger-color, #dc3545);
  background: none;
  padding: 0 2px;
  border-bottom: 1px dashed currentColor;
}
.questionAudioPlaceholder {
  font-style: italic;
  color: var(--text-color, #555);
  margin-bottom: 15px;
  /* padding: 10px 0; */
  background-color: transparent;
  border: none;
  text-align: left;
}
.questionImage {
  max-width: 100%;
  max-height: 300px; /* THÊM: Giới hạn chiều cao tối đa */
  width: auto;
  height: auto;
  object-fit: contain; /* THÊM: Giữ tỷ lệ khung hình */
  display: block;
  margin: 15px auto;
  border: 1px solid #e9ecef;
  border-radius: 4px;
}

/* --- Options List --- */

.optionsList {
  list-style: none;
  padding: 10px 0 0 0;
  margin: 0;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 5px 25px;
}
.questionBlock[data-option-type="image"] .optionsList {
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  max-width: 550px;
  margin-left: 0;
  margin-right: 0;
}

.optionItem {
  margin-bottom: 0;
  padding: 6px 0;
  border: 2px solid transparent;
  border-radius: 6px;
  background-color: transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  flex-direction: row;
  align-items: baseline;
  text-align: left;
  box-shadow: none;
}
.questionBlock[data-option-type="image"] .optionItem {
  background-color: #fff;
  border-color: #e9ecef;
  border-style: solid;
  border-width: 2px;
  flex-direction: column;
  align-items: center;
  text-align: center;
  /* padding: 12px; */
  box-shadow: none;
  transition: border-color 0.2s ease, background-color 0.2s ease;
}

.optionItem:hover:not(.submitted *) {
  background-color: transparent;
}
.questionBlock:not([data-option-type="image"]) .optionItem:hover:not(.submitted *) .optionText,
.questionBlock:not([data-option-type="image"]) .optionItem:hover:not(.submitted *) .optionMarker {
  color: var(--primary-color, #0d6efd);
}
.questionBlock[data-option-type="image"] .optionItem:hover:not(.submitted *) {
  background-color: #f8f9fa;
  border-color: #ced4da;
  box-shadow: none;
}

/* CSS Flexbox với padding được cập nhật */
.optionsList {
  display: flex;
  flex-wrap: wrap;
  gap: 10px 20px; /* Khoảng cách hàng (10px) và cột (20px). Điều chỉnh nếu cần. */
  list-style: none;
  padding: 0;
  margin: 0;
  position: relative;
}

.optionItem {
  display: flex;
  align-items: baseline;
  /* CẬP NHẬT PADDING TẠI ĐÂY */
  padding: 0 24px; /* Trên dưới 0px, Trái phải 26px */

  box-sizing: border-box; /* Quan trọng để padding không làm tăng kích thước tổng thể một cách không mong muốn */

  flex-grow: 1;
  flex-shrink: 1;
  flex-basis: auto;
  min-width: min-content; /* Chiều rộng tối thiểu là chiều rộng thực của text (không xuống dòng) */
}

.optionMarker {
  margin-right: 0.5em; /* Khoảng cách sau marker (ví dụ: ①) */
}

.optionText {
  white-space: nowrap;     /* Chữ không xuống dòng */
  text-align: left;
  overflow: hidden;        /* Ẩn nếu text quá dài */
  text-overflow: ellipsis; /* Hiển thị "..." */
}

/* Các style phụ trợ tối giản, không màu mè */
.optionImage { /* Nếu bạn có ảnh trong đáp án */
  max-height: 30px; /* Ví dụ giới hạn chiều cao ảnh */
  width: auto;
  margin-left: 0.5em;
  flex-shrink: 0;
}

/* Không thêm style màu mè cho trạng thái, giữ sự đơn giản */
.selectedOption {}
.correctAnswer {}
.selectedIncorrect {}

/* --- Style khi chọn (CHƯA NỘP BÀI) --- */
.optionItem.selectedOption:not([data-option-type="image"] *) .optionMarker,
.optionItem.selectedOption:not([data-option-type="image"] *) .optionText {
  color: var(--primary-color, #0d6efd) !important;
  font-weight: 600;
  text-decoration: none;
}
.questionBlock[data-option-type="image"] .optionItem.selectedOption {
  border-color: var(--primary-color, #0d6efd) !important;
  background-color: var(--primary-color-light, #e7f3ff) !important;
  box-shadow: none !important;
}
.questionBlock[data-option-type="image"] .optionItem.selectedOption .optionMarker {
  color: var(--primary-color-text, #0a58ca);
}

/* --- Option Marker & Text --- */
.optionMarker {
  font-weight: bold;
  margin-right: 10px;
  color: #333;
  font-size: 1.1em;
  line-height: 1.6;
  min-width: 25px;
  display: inline-block;
  text-align: center;
  transition: color 0.2s ease;
  flex-shrink: 0;
}
.questionBlock[data-option-type="image"] .optionMarker {
  width: 100%;
  text-align: center;
  margin-bottom: 8px;
  margin-right: 0;
  min-width: auto;
}
.questionBlock:not([data-option-type="image"]) .optionMarker {
  width: auto;
  text-align: center;
  margin-bottom: 0;
  margin-right: 10px;
}

.optionText {
  font-size: 1.1em;
  color: #333;
  line-height: 1.6;
  transition: color 0.2s ease;
  text-decoration: none;
  white-space: pre-wrap;
  word-wrap: break-word;
}
.optionImage {
  max-width: 100%;
  max-height: 140px; /* GIỮ: Giới hạn chiều cao */
  width: auto;
  height: auto;
  object-fit: contain; /* THÊM: Giữ tỷ lệ khung hình */
  margin: 0 auto;
  border-radius: 4px;
  border: none;
  display: block;
}

/* --- Complex Task Styles --- */
.orderingTask {
  margin-top: 15px;
  padding-left: 0;
}
.orderingTask .orderingItem {
  background-color: #f8f9fa;
  padding: 10px 12px;
  margin-bottom: 8px;
  border-radius: 4px;
  display: flex;
  align-items: baseline;
  border: 1px solid #f1f3f5;
}
.orderingTask .orderingItem .marker {
  font-weight: bold;
  margin-right: 12px;
  min-width: 30px;
  color: var(--text-color, #495057);
  font-size: 1.05em;
}
.orderingTask .orderingItem .text {
  white-space: pre-wrap;
  word-wrap: break-word;
  flex: 1;
  line-height: 1.6;
}

.insertionTask {
  margin-top: 15px;
}
.insertionTask .itemToInsert {
  /* background-color: #fff9db; */
  padding: 10px 15px;
  margin-bottom: 15px;
  border-radius: 4px;
  border: 1px solid #ccc;
  font-style: italic;
  font-weight: 500;
}
.insertionTask .mainPassage {
  margin-top: 10px;
  padding: 15px 20px;
  border: 1px solid #e9ecef;
  white-space: pre-wrap;
  word-wrap: break-word;
  background-color: #f8f9fa;
  border-radius: 4px;
  line-height: 1.7;
  font-size: 1.05em;
}
.insertionTask .insertionPoint {
  font-weight: bold;
  color: var(--primary-color, #0d6efd);
  background: var(--primary-color-light, #e7f3ff);
  padding: 1px 6px;
  border-radius: 3px;
  display: inline-block;
  margin: 0 2px;
  cursor: default;
  font-size: 1.05em;
}

/* === Submission & Feedback Styles === */
.submitted .optionItem {
  cursor: default;
}
.submitted .optionItem:hover {
  background-color: transparent;
  transform: none;
  box-shadow: none;
  border-color: transparent;
}
.submitted .questionBlock[data-option-type="image"] .optionItem:hover {
  background-color: #fff;
  border-color: #e9ecef;
  box-shadow: none;
}

/* -- Phản hồi cho TEXT options -- */
.submitted .optionItem.selectedOption:not([data-option-type="image"] *) .optionMarker,
.submitted .optionItem.selectedOption:not([data-option-type="image"] *) .optionText {
  color: var(--text-color-main, #343a40) !important;
  font-weight: normal;
  text-decoration: none !important;
}
.submitted .questionBlock:not([data-option-type="image"]) .optionItem.correctAnswer .optionMarker,
.submitted .questionBlock:not([data-option-type="image"]) .optionItem.correctAnswer .optionText {
  color: var(--success-color, #198754) !important;
  font-weight: 700 !important;
  text-decoration: none !important;
}
.submitted .questionBlock:not([data-option-type="image"]) .optionItem.selectedIncorrect .optionMarker,
.submitted .questionBlock:not([data-option-type="image"]) .optionItem.selectedIncorrect .optionText {
  color: var(--danger-color, #dc3545) !important;
  opacity: 0.7;
}
.submitted .questionBlock:not([data-option-type="image"]) .optionItem.selectedIncorrect .optionText {
  text-decoration: line-through !important;
  text-decoration-color: rgba(220, 53, 69, 0.7) !important;
}
.submitted .questionBlock:not([data-option-type="image"]) .optionItem.selectedIncorrect.correctAnswer .optionMarker,
.submitted .questionBlock:not([data-option-type="image"]) .optionItem.selectedIncorrect.correctAnswer .optionText {
  color: var(--success-color, #198754) !important;
  font-weight: 700 !important;
  text-decoration: none !important;
  opacity: 1;
}

/* -- Phản hồi cho IMAGE options -- */
.submitted .questionBlock[data-option-type="image"] .optionItem {
  box-shadow: none !important;
  opacity: 1;
  background-color: #fff !important;
  border-color: #e9ecef !important;
  border-width: 2px !important;
}
.submitted .questionBlock[data-option-type="image"] .optionItem .optionMarker {
  color: #333;
  font-weight: bold;
}
.submitted .questionBlock[data-option-type="image"] .optionItem.selectedIncorrect {
  border-color: var(--danger-color, #dc3545) !important;
  background-color: var(--danger-color-light, #f8d7da) !important;
  opacity: 0.75;
}
.submitted .questionBlock[data-option-type="image"] .optionItem.selectedIncorrect .optionMarker {
  color: var(--danger-color-text, #842029);
}
.submitted .questionBlock[data-option-type="image"] .optionItem.correctAnswer {
  border-color: var(--success-color, #198754) !important;
  border-width: 3px !important;
  background-color: var(--success-color-light, #cce8d8) !important;
  opacity: 1;
}
.submitted .questionBlock[data-option-type="image"] .optionItem.correctAnswer .optionMarker {
  color: var(--success-color-text, #0f5132);
  font-weight: 700 !important;
}
.questionBlock[data-option-type="image"] .optionItem.selectedCorrect::after,
.questionBlock[data-option-type="image"] .optionItem.selectedIncorrect::after {
  content: none;
}

/* --- Khu vực Nộp Bài --- */
.submissionArea {
  margin-top: 40px;
  text-align: center;
  padding-top: 0;
  border-top: none;
}
.submitButton {
  display: inline-block;
  padding: 12px 35px;
  background: #555;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 1.1em;
  transition: background-color 0.3s ease;
  font-weight: 500;
  box-shadow: none;
}
.submitButton:hover {
  background: #333;
}
.submitButton:disabled {
  background: #ccc;
  cursor: not-allowed;
  box-shadow: none;
}
.scoreDisplay {
  font-size: 1.3em;
  font-weight: bold;
  color: var(--success-color, #198754);
  margin-top: 15px;
}

/* --- Sidebar Styles --- */
.sidebarActionArea {
  padding-bottom: 20px;
  margin-bottom: 15px;
  border-bottom: 1px solid var(--border-color, #dee2e6);
  text-align: center;
  flex-shrink: 0;
}
.timerDisplay {
  font-size: 1.7em;
  font-weight: 600;
  color: var(--text-color-main, #343a40);
  margin-bottom: 15px;
  background-color: transparent;
  padding: 5px 0;
  border-radius: 0;
  border: none;
  font-family: 'Roboto Mono', monospace;
  letter-spacing: 1px;
}
.timerIcon {
  margin-right: 6px;
  font-size: 0.8em;
  vertical-align: middle;
  display: inline-block;
  margin-top: -2px;
}
.timerWarning {
  color: var(--danger-color, #dc3545);
  animation: none;
}
.submitButtonSidebar {
  width: 100%;
  padding: 11px 15px;
  font-size: 1.05em;
  margin-bottom: 15px;
  font-weight: 600;
  background-color: var(--primary-color, #0d6efd);
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  box-shadow: none;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.submitButtonSidebar:hover {
  background-color: #0b5ed7;
  box-shadow: none;
  transform: translateY(-1px);
}
.submitButtonSidebar:disabled {
  background: #adb5bd;
  cursor: not-allowed;
  box-shadow: none;
  transform: none;
  opacity: 0.7;
}
.scoreDisplaySidebar {
  font-size: 1.15em;
  font-weight: 600;
  color: var(--success-color-text, #0f5132);
  margin-top: 10px;
  padding: 10px;
  background-color: var(--success-color-light, #cce8d8);
  border-radius: 6px;
  border: 1px solid var(--success-color-border, #a3cfbb);
}
.questionNavList {
  list-style: none;
  padding: 5px 0 0 0;
  margin: 0;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));
  gap: 6px;
  flex-grow: 1;
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: #ced4da #f1f3f5;
  padding-right: 5px;
}
.questionNavList::-webkit-scrollbar { width: 5px; }
.questionNavList::-webkit-scrollbar-track { background: transparent; }
.questionNavList::-webkit-scrollbar-thumb { background-color: #ced4da; border-radius: 3px; }

.questionNavItem {
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #e9ecef;
  border-radius: 6px;
  padding: 8px 4px;
  cursor: pointer;
  font-size: 0.9em;
  background-color: #fff;
  transition: all 0.2s ease;
  min-height: 40px;
  text-align: center;
  box-shadow: none;
  position: relative;
  line-height: 1;
}
.questionNavItem:hover {
  background-color: #f1f3f5;
  border-color: #adb5bd;
  transform: translateY(-1px);
  box-shadow: none;
}
.questionNavNumber {
  font-weight: 500;
  color: #495057;
  font-size: 1em;
}

/* Trạng thái Sidebar Item (Màu nền) */
.questionNavItem.navAnswered {
  background-color: var(--primary-color-light, #cfe2ff);
  border-color: var(--primary-color-border, #a3c7ff);
}
.questionNavItem.navAnswered .questionNavNumber {
  color: var(--primary-color-text, #0a58ca);
  font-weight: 600;
}
.questionNavItem.navUnanswered {
  background-color: #f8f9fa;
  opacity: 0.7;
  border-color: #e9ecef;
}
.questionNavItem.navUnanswered .questionNavNumber {
  color: #6c757d;
}
.questionNavItem.navCorrect {
  background-color: var(--success-color-light, #cce8d8);
  border-color: var(--success-color, #198754);
  font-weight: 700;
}
.questionNavItem.navCorrect .questionNavNumber {
  color: var(--success-color-text, #0f5132);
}
.questionNavItem.navIncorrect {
  background-color: var(--danger-color-light, #f8d7da);
  border-color: var(--danger-color, #dc3545);
}
.questionNavItem.navIncorrect .questionNavNumber {
  color: var(--danger-color-text, #842029);
  font-weight: normal;
}
.questionNavItem.navCorrect::after, .questionNavItem.navIncorrect::after {
  content: none;
}

/* --- Khu vực nộp bài cho Mobile --- */
.mobileSubmitArea {
  display: none;
  margin-top: 40px;
  padding-top: 0;
  border-top: none;
  background-color: transparent;
  padding: 15px 0 0 0;
  text-align: center;
}
.timerDisplayMobile {
  font-size: 1.2em;
  font-weight: 600;
  color: var(--heading-color, #212529);
  margin-bottom: 15px;
  text-align: center;
  font-family: 'Roboto Mono', monospace;
}
.timerDisplayMobile.timerWarning {
  color: var(--danger-color, #dc3545);
}
.mobileSubmitArea .submitButton {
  padding: 12px 30px;
  font-size: 1.1em;
  background-color: var(--primary-color, #0d6efd);
}
.mobileSubmitArea .submitButton:hover {
  background-color: #0b5ed7;
}
.mobileSubmitArea .submitButton:disabled {
  background: #adb5bd;
}
.scoreDisplay {
  font-size: 1.3em;
  font-weight: bold;
  color: var(--success-color, #198754);
  margin-top: 15px;
}

/* --- Styling for Explanation & Chat (Inline Version) --- */
.explanationArea {
  margin-top: 25px;
  padding-top: 15px;
  border-top: 1px dashed var(--border-color, #dee2e6);
  text-align: left;
}

.detailsButton {
  padding: 7px 16px;
  font-size: 0.9em;
  border-radius: 15px;
  cursor: pointer;
  border: 1px solid var(--primary-color-border, #a3c7ff);
  background-color: #fff;
  color: var(--primary-color, #0d6efd);
  transition: all 0.2s ease;
  font-weight: 500;
  margin-bottom: 15px;
}
.detailsButton:hover {
  background-color: var(--primary-color-light, #e7f3ff);
  border-color: var(--primary-color, #0d6efd);
}
.detailsButton:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.detailsPanel {
  border: 1px solid var(--border-color, #dee2e6);
  border-radius: 8px;
  padding: 20px 25px;
  margin-top: 10px;
  background-color: #fff;
  box-shadow: none;
}

.modalTranslationArea {
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid var(--border-color-light, #f1f3f5);
  font-size: 1em;
}
.modalTranslationArea strong {
  display: block;
  margin-bottom: 10px;
  font-weight: 600;
  color: var(--heading-color, #212529);
  font-size: 1.05em;
}
.modalTranslationArea p {
  margin: 0;
  white-space: pre-wrap;
  line-height: 1.65;
  color: var(--text-color-main, #343a40);
}
.modalTranslationArea .explanationButton {
  margin-bottom: 10px;
}
.modalTranslationArea .errorMessage {
  color: var(--danger-color-text, #842029);
  font-style: italic;
  background: none;
  border: none;
  padding: 0;
}
.modalTranslationArea p i {
  color: var(--text-color, #6c757d);
}

.modalChatArea {
  margin-top: 20px;
  padding-top: 15px;
  border-top: 1px solid var(--border-color-light, #f1f3f5);
}
.chatAreaTitle {
  margin: 0 0 15px 0;
  font-size: 1.1em;
  font-weight: 600;
  color: var(--heading-color, #212529);
  text-align: left;
  padding-bottom: 0;
  border-bottom: none;
}
.chatBody {
  max-height: 350px;
  overflow-y: auto;
  margin-bottom: 15px;
  padding: 10px 5px 10px 10px;
  border: 1px solid var(--border-color, #dee2e6);
  border-radius: 6px;
  background-color: #fff;
  scrollbar-width: thin;
  scrollbar-color: #ced4da #f1f3f5;
}
.chatBody::-webkit-scrollbar { width: 6px; }
.chatBody::-webkit-scrollbar-track { background: #f1f3f5; border-radius: 3px; }
.chatBody::-webkit-scrollbar-thumb { background-color: #ced4da; border-radius: 3px; }

.chatMessage {
  margin-bottom: 12px;
  padding: 10px 15px;
  border-radius: 18px;
  max-width: 80%;
  word-wrap: break-word;
  line-height: 1.5;
  font-size: 1em;
  clear: both;
  box-shadow: none;
}
.chatMessage p {
  margin: 0;
  white-space: pre-wrap;
}
.chatMessage i {
  color: var(--text-color, #495057);
  font-size: 0.95em;
}
.userMessage {
  background-color: var(--primary-color, #0d6efd);
  color: var(--chat-text-light, #ffffff);
  margin-left: auto;
  border-bottom-right-radius: 5px;
  float: right;
}
.aiMessage {
  background-color: var(--chat-ai-bg, #f1f3f5);
  color: var(--chat-text-dark, #343a40);
  margin-right: auto;
  border-bottom-left-radius: 5px;
  float: left;
}
.chatMessage::after {
  content: "";
  display: table;
  clear: both;
}

.chatInputArea {
  display: flex;
  gap: 8px;
  border-top: 1px solid var(--border-color-light, #f1f3f5);
  padding-top: 15px;
  margin-top: 10px;
}
.chatTextarea {
  flex-grow: 1;
  padding: 10px 15px;
  border: 1px solid var(--border-color, #dee2e6);
  border-radius: 20px;
  resize: none;
  font-size: 1em;
  font-family: inherit;
  line-height: 1.5;
  min-height: 42px;
  max-height: 100px;
}
.chatTextarea:focus {
  outline: none;
  border-color: var(--primary-color, #0d6efd);
  box-shadow: none;
}
.chatTextarea:disabled {
  background-color: #e9ecef;
  cursor: not-allowed;
}
.chatSendButton {
  flex-shrink: 0;
  padding: 0 18px;
  background-color: var(--primary-color, #0d6efd);
  color: white;
  border: none;
  border-radius: 20px;
  cursor: pointer;
  font-weight: 500;
  transition: background-color 0.2s ease;
  font-size: 1em;
  height: 42px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.chatSendButton:hover:not(:disabled) {
  background-color: #0b5ed7;
}
.chatSendButton:disabled {
  background-color: #adb5bd;
  cursor: not-allowed;
}
.chatError {
  font-size: 0.9em;
  color: var(--danger-color);
  margin-top: 8px;
  text-align: right;
  font-style: italic;
}

/* --- Responsiveness --- */
@media (max-width: 991.98px) {
  .appContainer {
      display: block;
      max-width: 100%;
      padding: 0 15px;
      margin: 25px auto;
      gap: 0;
  }
  .sidebar {
      display: none;
  }
  .mainContent {
      flex: none;
      width: auto;
      max-width: 850px;
      margin-left: auto;
      margin-right: auto;
      margin-top: 0;
      margin-bottom: 25px;
      padding: 25px 15px;
  }
  .mobileSubmitArea {
      display: block;
  }
  .submissionArea:not(.mobileSubmitArea) {
      display: none;
  }
}

@media (max-width: 768px) {
  .mainContent {
      max-width: 100%;
      padding: 20px 15px;
      margin-left: 0;
      margin-right: 0;
  }
  .appContainer {
      margin: 15px auto;
      padding: 0 10px;
  }
  .examTitle {
      font-size: 1.4em;
  }
  .optionsList:not(.questionBlock[data-option-type="image"] .optionsList) {
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  }
  .questionBlock[data-option-type="image"] .optionsList {
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      max-width: none;
  }
  .optionImage {
      max-height: 120px; /* GIẢM: Phù hợp với màn hình nhỏ hơn */
  }
  .questionImage, .sharedImage {
      max-height: 250px; /* GIẢM: Phù hợp với màn hình nhỏ hơn */
  }
  .timerDisplayMobile {
      font-size: 1.1em;
  }
  .mobileSubmitArea .submitButton {
      padding: 10px 25px;
      font-size: 1em;
  }
  .scoreDisplay {
      font-size: 1.2em;
  }
}

@media (max-width: 575.98px) {
  .mainContent {
      max-width: 100%;
      margin: 15px 0;
      padding: 20px 10px;
      border-left: none;
      border-right: none;
      border-radius: 0;
  }
  .appContainer {
      padding: 0;
      margin: 15px 0;
  }
  .optionsList:not(.questionBlock[data-option-type="image"] .optionsList) {
      grid-template-columns: 1fr;
      gap: 8px 0;
  }
  .questionBlock[data-option-type="image"] .optionsList {
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
  }
  .optionImage {
      max-height: 100px; /* GIẢM: Phù hợp với màn hình rất nhỏ */
  }
  .questionImage, .sharedImage {
      max-height: 200px; /* GIẢM: Phù hợp với màn hình rất nhỏ */
  }
}

/* --- Xóa style modal (vì không dùng ChatModal) --- */

/* styles/Exam.module.css */

/* ... (Các style khác giữ nguyên) ... */

/* --- Styling for Explanation Area --- */
.explanationArea { /* ... (Giữ nguyên) ... */ }
.detailsButton { /* ... (Giữ nguyên) ... */ }
.detailsPanel { /* ... (Giữ nguyên) ... */ }

/* Style cho phần dịch trong panel */
.translationSection {
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--border-color-light);
    font-size: 1em;
}
.translationSection strong {
    display: block;
    margin-bottom: 10px;
    font-weight: 600;
    font-size: 1.05em;
    color: var(--heading-color);
    /* Có thể bỏ border bottom ở đây nếu không muốn */
    /* border-bottom: 1px dotted #ccc; */
    /* padding-bottom: 5px; */
}
.translationSection p { margin: 0 0 5px 0; white-space: pre-wrap; line-height: 1.65; color: var(--text-color-main); }
.translationSection .explanationButton { /* ... */ }
.translationSection .errorMessage { /* ... */ }
.translationSection p i { /* ... */ }

/* === Style MỚI cho các phần dịch riêng biệt === */
.translationQuestionPart {
    margin-bottom: 15px; /* Khoảng cách giữa 2 phần */
}
.translationOptionsPart pre {
     /* Dùng pre để giữ định dạng xuống dòng và thụt lề (nếu có) từ API */
     white-space: pre-wrap;
     word-wrap: break-word;
     margin: 0;
     padding: 10px 0 0 0; /* Thêm padding top nhẹ */
     font-family: inherit; /* Kế thừa font */
     font-size: 1em;
     line-height: 1.7; /* Tăng nhẹ cho dễ đọc lựa chọn */
     color: var(--text-color-main);
     background: none; /* Bỏ nền mặc định của pre */
     border: none; /* Bỏ viền mặc định của pre */
}
/* ============================================ */


/* --- Chat Styles --- */
.inlineChatArea { /* ... (Giữ nguyên) ... */ }
/* ... (Các style chat khác giữ nguyên) ... */


/* --- Responsive etc. --- */
/* ... (Giữ nguyên) ... */

/* ../exams/Exam.module.css */

/* ... các style cũ ... */

/* Container cho trình phát audio - Tinh chỉnh lại */
.audioPlayerContainer {
  /* Bỏ nền, shadow, border trên cùng để hòa vào nền trang */
  background-color: transparent;
  box-shadow: none;
  border: none; /* Hoặc giữ lại border-bottom nếu muốn có ngăn cách */
  /* border-bottom: 1px solid #eee; */

  border-radius: 0; /* Bỏ bo góc nếu không còn viền/nền */
  padding: 0; /* Bỏ padding để audio chiếm trọn chiều rộng */
  margin-bottom: 30px; /* Giữ khoảng cách dưới với nội dung */
  margin-top: 10px; /* Thêm khoảng cách trên nếu cần */
}

/* Xóa hẳn class này đi vì không còn dùng */
/*
.audioPlayerTitle {
  font-size: 1.1rem;
  font-weight: 600;
  color: #343a40;
  margin-bottom: 15px;
}
*/

/* Đảm bảo audio player chiếm full width và hiển thị dạng block */
.audioPlayer {
  width: 100%;
  display: block; /* Quan trọng để chiếm hết chiều rộng */
  height: 50px; /* Có thể điều chỉnh chiều cao */
  /* Tùy chọn: Thêm chút bo góc cho chính thanh player nếu trình duyệt hỗ trợ */
  /* border-radius: 6px; */
}


/* ... các style còn lại ... */


